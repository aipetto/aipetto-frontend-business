(this["webpackJsonpapp-frontend"]=this["webpackJsonpapp-frontend"]||[]).push([[13],{568:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return r}))},569:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,"a",(function(){return a}))},570:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(207);function a(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Object(r.a)(e,t)}},571:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(579),a=n.n(r),o=n(586);function s(e,t){return!t||"object"!==a()(t)&&"function"!==typeof t?Object(o.a)(e):t}},572:function(e,t,n){"use strict";function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.d(t,"a",(function(){return r}))},578:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return r}))},579:function(e,t){function n(t){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?(e.exports=n=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=n=function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),n(t)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},586:function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"a",(function(){return r}))},608:function(e,t,n){"use strict";var r=n(5),a=n(31),o=n(50),s=n(130),c=Object(r.a)([a.a.selectCurrentTenant,a.a.selectCurrentUser],(function(e,t){return new o.a(e,t).match(s.a.values.userRead)})),i=Object(r.a)([a.a.selectCurrentTenant,a.a.selectCurrentUser],(function(e,t){return new o.a(e,t).match(s.a.values.userEdit)})),l=Object(r.a)([a.a.selectCurrentTenant,a.a.selectCurrentUser],(function(e,t){return new o.a(e,t).match(s.a.values.userDestroy)})),u={selectPermissionToRead:c,selectPermissionToEdit:i,selectPermissionToCreate:Object(r.a)([a.a.selectCurrentTenant,a.a.selectCurrentUser],(function(e,t){return new o.a(e,t).match(s.a.values.userCreate)})),selectPermissionToImport:Object(r.a)([a.a.selectCurrentTenant,a.a.selectCurrentUser],(function(e,t){return new o.a(e,t).match(s.a.values.userImport)})),selectPermissionToDestroy:l};t.a=u},625:function(e,t,n){"use strict";var r=n(206),a={status:["active","invited","empty-permissions"],roles:Object.keys(r.a.values)};t.a=a},635:function(e,t,n){"use strict";var r=n(135),a=n(4),o=n.n(a),s=(n(597),n(24)),c=(n(598),n(596)),i=n(578),l=n(568),u=n(569),d=(n(20),n(570)),b=n(571),m=n(572),f=(n(576),n(112),n(579),n(577)),j=n(567),O=(n(565),n(599),n(584),n(600));function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(m.a)(e);if(t){var a=Object(m.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=String(e).toLowerCase(),r=String(t.value).toLowerCase(),a=String(t.label).toLowerCase();return r===n||a===n},v=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){Object(i.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({allowCreateWhileLoading:!1,createOptionPosition:"last"},{formatCreateLabel:function(e){return'Create "'.concat(e,'"')},isValidNewOption:function(e,t,n){return!(!e||t.some((function(t){return h(e,t)}))||n.some((function(t){return h(e,t)})))},getNewOptionData:function(e,t){return{label:t,value:e,__isNew__:!0}}}),y=function(e){var t,n;return n=t=function(t){Object(d.a)(r,t);var n=p(r);function r(e){var t;Object(l.a)(this,r),(t=n.call(this,e)).select=void 0,t.onChange=function(e,n){var r=t.props,a=r.getNewOptionData,o=r.inputValue,s=r.isMulti,i=r.onChange,l=r.onCreateOption,u=r.value,d=r.name;if("select-option"!==n.action)return i(e,n);var b=t.state.newOption,m=Array.isArray(e)?e:[e];if(m[m.length-1]!==b)i(e,n);else if(l)l(o);else{var j=a(o,o),O={action:"create-option",name:d};i(s?[].concat(Object(c.a)(Object(f.b)(u)),[j]):j,O)}};var a=e.options||[];return t.state={newOption:void 0,options:a},t}return Object(u.a)(r,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.allowCreateWhileLoading,n=e.createOptionPosition,r=e.formatCreateLabel,a=e.getNewOptionData,o=e.inputValue,s=e.isLoading,i=e.isValidNewOption,l=e.value,u=e.options||[],d=this.state.newOption;d=i(o,Object(f.b)(l),u)?a(o,r(o)):void 0,this.setState({newOption:d,options:!t&&s||!d?u:"first"===n?[d].concat(Object(c.a)(u)):[].concat(Object(c.a)(u),[d])})}},{key:"focus",value:function(){this.select.focus()}},{key:"blur",value:function(){this.select.blur()}},{key:"render",value:function(){var t=this,n=this.state.options;return o.a.createElement(e,Object(s.a)({},this.props,{ref:function(e){t.select=e},options:n,onChange:this.onChange}))}}]),r}(a.Component),t.defaultProps=v,n}(j.a),x=Object(O.a)(y),w=n(2),C=n(556),k=n(557),N=n(27),S=n(77),P=n(575),L=n(672),E=n(7);function D(e){var t=Object(a.useState)(Object(L.a)()),n=Object(r.a)(t,1)[0],o=e.label,s=e.name,c=e.hint,i=e.externalErrorMessage,l=e.required,u=e.placeholder,d=e.isClearable,b=e.notFoundContent,m=Object(C.d)(),f=m.register,j=m.errors,O=m.formState,p=O.touched,g=O.isSubmitted,h=m.setValue,v=m.watch,y=Object(N.e)(S.a.selectDarkMode),D=k.a.errorMessage(s,j,p,g,i);Object(a.useEffect)((function(){f({name:s})}),[f,s]);var T=v(s),_=Object(P.a)(y,Boolean(D));return Object(E.jsxs)("div",{children:[Boolean(o)&&Object(E.jsxs)("label",{className:"block text-sm text-gray-800 dark:text-gray-200",htmlFor:n,children:[o," ",l?Object(E.jsx)("span",{className:"text-sm text-red-400",children:"*"}):null]}),Object(E.jsx)(x,{className:"w-full mt-2",value:T&&T.length?T.map((function(e){return{value:e,label:e}})):[],onChange:function(t){if(!t||!t.length)return h(s,null,{shouldValidate:!0}),void(e.onChange&&e.onChange(null));var n=t.map((function(e){return e.value})).join(",").split(",");h(s,n,{shouldValidate:!0}),e.onChange&&e.onChange(n)},onBlur:function(t){e.onBlur&&e.onBlur(t)},id:n,name:s,placeholder:u||"",isClearable:d,styles:_,isMulti:!0,formatCreateLabel:function(e){return e},loadingMessage:function(){return Object(w.d)("autocomplete.loading")},noOptionsMessage:function(){return b||""}}),Object(E.jsx)("div",{className:"text-red-600 text-sm mt-2",children:D}),Boolean(c)&&Object(E.jsx)("div",{className:"text-gray-500 text-sm mt-2",children:c})]})}D.defaultProps={required:!1,isClearable:!0};t.a=D},636:function(e,t,n){"use strict";var r=n(0),a=n(135),o=n(560),s=n(25),c=n(71),i=n(566),l=n(4),u=n(556),d=n(2),b=n(564),m=n(625),f=n(561),j=n(593),O=n(635),p=n(33),g=n(7),h=p.e().shape({email:b.a.email(Object(d.d)("user.fields.email")),roles:b.a.stringArray(Object(d.d)("user.fields.roles"),{required:!0,min:1})}),v=p.e().shape({emails:p.a().label(Object(d.d)("user.fields.emails")).of(p.h().transform((function(e,t){return""===t?null:e})).email(Object(d.d)("user.validations.email")).label(Object(d.d)("user.fields.email")).max(255).required()).required().min(1),roles:b.a.stringArray(Object(d.d)("user.fields.roles"),{required:!0,min:1})});t.a=function(e){var t=e.single,n=e.saveLoading,b=e.single?h:v,p=Object(l.useState)((function(){return{emails:[],email:"",roles:[]}})),y=Object(a.a)(p,1)[0],x=Object(u.c)({resolver:Object(i.yupResolver)(b),mode:"all",defaultValues:y}),w=function(t){var n=Object.assign({},t);n.email&&(n.emails=[n.email],delete n.email),e.onSubmit(null,n)};return Object(g.jsx)(u.a,Object(r.a)(Object(r.a)({},x),{},{children:Object(g.jsxs)("form",{onSubmit:x.handleSubmit(w),children:[Object(g.jsx)("div",{className:"w-full sm:w-md md:w-md lg:w-md",children:t?Object(g.jsx)(f.a,{name:"email",label:Object(d.d)("user.fields.email"),required:!0,autoFocus:!0}):Object(g.jsx)(O.a,{name:"emails",label:Object(d.d)("user.fields.emails"),notFoundContent:Object(d.d)("user.new.emailsHint"),required:!0})}),Object(g.jsx)("div",{className:"w-full sm:w-md md:w-md lg:w-md mt-4",children:Object(g.jsx)(j.a,{name:"roles",label:Object(d.d)("user.fields.roles"),required:!0,options:m.a.roles.map((function(e){return{value:e,label:Object(d.d)("roles.".concat(e,".label"))}})),mode:"multiple"})}),Object(g.jsxs)("div",{className:"pt-4",children:[Object(g.jsxs)("button",{className:"mr-2 mb-2 text-sm disabled:opacity-50 disabled:cursor-default px-4 py-2 tracking-wide text-white transition-colors duration-200 transform bg-gray-700 rounded-md hover:bg-gray-600 focus:outline-none focus:bg-gray-600",disabled:n,type:"button",onClick:x.handleSubmit(w),children:[Object(g.jsx)(c.a,{className:"mr-2",icon:o.e}),Object(d.d)("common.save")]}),Object(g.jsxs)("button",{disabled:n,onClick:function(){Object.keys(y).forEach((function(e){x.setValue(e,y[e])}))},className:"mr-2 mb-2 text-sm disabled:opacity-50 disabled:cursor-default px-4 py-2 tracking-wide dark:border-gray-800 dark:bg-gray-800 dark:hover:bg-gray-600 dark:text-white text-gray-700 border border-gray-300 transition-colors duration-200 transform bg-white rounded-md hover:bg-gray-100 focus:outline-none focus:bg-gray-100",type:"button",children:[Object(g.jsx)(c.a,{className:"mr-2",icon:s.t}),Object(d.d)("common.reset")]}),e.onCancel?Object(g.jsxs)("button",{disabled:n,onClick:function(){return e.onCancel()},className:"mr-2 mb-2 text-sm disabled:opacity-50 disabled:cursor-default px-4 py-2 tracking-wide dark:border-gray-800 dark:bg-gray-800 dark:hover:bg-gray-600 dark:text-white text-gray-700 border border-gray-300 transition-colors duration-200 transform bg-white rounded-md hover:bg-gray-100 focus:outline-none focus:bg-gray-100",type:"button",children:[Object(g.jsx)(c.a,{className:"mr-2",icon:s.s}),Object(d.d)("common.cancel")]}):null]})]})}))}},637:function(e,t,n){"use strict";var r=n(0),a=n(19),o=n(135),s=n(4),c=n(66),i=n(1),l=n.n(i),u=n(3),d=n(25),b=n(71),m=n(112),f=n.n(m),j=n(2),O=n(6),p=n(636),g=n(7);var h=function(e){var t=Object(s.useState)(!1),n=Object(o.a)(t,2),r=n[0],a=n[1],i=function(){var t=Object(u.a)(l.a.mark((function t(n,r){var o,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a(!0),t.next=4,c.a.create(r);case 4:return t.next=6,c.a.fetchUsers({email:r.emails[0]},null,1,0);case 6:o=t.sent,s=o.rows,e.onSuccess(s[0]),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),O.a.handle(t.t0);case 14:return t.prev=14,a(!1),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[0,11,14,17]])})));return function(e,n){return t.apply(this,arguments)}}();return f.a.createPortal(Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("div",{className:"justify-center items-center flex overflow-x-hidden overflow-y-auto fixed inset-0 z-50 outline-none focus:outline-none",tabIndex:-1,onClick:e.onClose,children:Object(g.jsx)("div",{className:"relative my-6 mx-auto w-auto",onClick:function(e){return e.stopPropagation()},children:Object(g.jsxs)("div",{className:"border-0 rounded-lg shadow-lg relative flex flex-col w-full bg-white outline-none focus:outline-none",children:[Object(g.jsxs)("div",{className:"flex items-start justify-between p-5 rounded-t",children:[Object(g.jsx)("div",{className:"text-lg font-semibold",children:Object(j.d)("user.new.titleModal")}),Object(g.jsx)("button",{type:"button",className:"ml-auto bg-transparent border-0 text-gray-900 float-right text-lg leading-none font-semibold outline-none focus:outline-none",onClick:e.onClose,children:Object(g.jsx)("span",{className:"bg-transparent text-gray-700 h-6 w-6 text-lg block outline-none focus:outline-none",children:Object(g.jsx)(b.a,{icon:d.s})})})]}),Object(g.jsx)("div",{className:"relative p-6 flex-auto",children:Object(g.jsx)(p.a,{saveLoading:r,onSubmit:i,onCancel:e.onClose,modal:!0,single:!0})})]})})}),Object(g.jsx)("div",{className:"opacity-25 fixed inset-0 z-40 bg-black"})]}),document.getElementById("modal-root"))},v=n(581),y=n(556),x=n(27),w=n(608);t.a=function(e){var t=Object(y.d)(),n=t.setValue,i=t.getValues,l=Object(s.useState)(!1),u=Object(o.a)(l,2),d=u[0],b=u[1],m=Object(x.e)(w.a.selectPermissionToCreate);return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(v.a,Object(r.a)(Object(r.a)({},e),{},{fetchFn:function(e,t){return c.a.fetchUserAutocomplete(e,t)},mapper:{toAutocomplete:function(e){if(!e)return null;if(e.fullName||e.email){var t=e.email;return e.fullName&&(t="".concat(e.fullName," <").concat(e.email,">")),{value:e.id,label:t}}return{value:e.id,label:e.label}},toValue:function(e){return e?{id:e.value,label:e.label}:null}},onOpenModal:function(){return b(!0)},hasPermissionToCreate:m})),d&&Object(g.jsx)(h,{visible:d,onClose:function(){return b(!1)},onSuccess:function(t){var r=e.name,o=e.mode;n(r,o&&"multiple"===o?[].concat(Object(a.a)(i()[r]||[]),[t]):t),b(!1)}})]})}},655:function(e,t,n){"use strict";var r=n(0),a=n(135),o=n(560),s=n(25),c=n(71),i=n(566),l=n(4),u=n(556),d=n(2),b=n(564),m=n(561),f=n(637),j=n(661),O=n(213),p=n(76),g=n.n(p),h=n(656),v=n(33),y=n(7),x=v.e().shape({name:b.a.string(Object(d.d)("entities.customer.fields.name"),{required:!0,min:2,max:255}),birthdate:b.a.date(Object(d.d)("entities.customer.fields.birthdate"),{}),gender:b.a.enumerator(Object(d.d)("entities.customer.fields.gender"),{options:O.a.gender}),userId:b.a.relationToOne(Object(d.d)("entities.customer.fields.userId"),{})});t.a=function(e){var t=e.saveLoading,n=Object(l.useState)((function(){var t=e.record||{};return{name:t.name,birthdate:t.birthdate?g()(t.birthdate,"YYYY-MM-DD").toDate():null,gender:t.gender,userId:t.userId}})),b=Object(a.a)(n,1)[0],p=Object(u.c)({resolver:Object(i.yupResolver)(x),mode:"all",defaultValues:b}),v=function(t){var n;e.onSubmit(null===(n=e.record)||void 0===n?void 0:n.id,t)};return Object(y.jsx)(u.a,Object(r.a)(Object(r.a)({},p),{},{children:Object(y.jsxs)("form",{onSubmit:p.handleSubmit(v),children:[Object(y.jsx)("div",{className:"w-full sm:w-md md:w-md lg:w-md",children:Object(y.jsx)(m.a,{name:"name",label:Object(d.d)("entities.customer.fields.name"),required:!0,autoFocus:!0})}),Object(y.jsx)("div",{className:"w-full sm:w-md md:w-md lg:w-md mt-4",children:Object(y.jsx)(h.a,{name:"birthdate",label:Object(d.d)("entities.customer.fields.birthdate"),required:!1})}),Object(y.jsx)("div",{className:"w-full sm:w-md md:w-md lg:w-md mt-4",children:Object(y.jsx)(j.a,{name:"gender",label:Object(d.d)("entities.customer.fields.gender"),options:O.a.gender.map((function(e){return{value:e,label:Object(d.d)("entities.customer.enumerators.gender.".concat(e))}})),required:!1})}),Object(y.jsx)("div",{className:"w-full sm:w-md md:w-md lg:w-md mt-4",children:Object(y.jsx)(f.a,{name:"userId",label:Object(d.d)("entities.customer.fields.userId"),required:!1,showCreate:!e.modal})}),Object(y.jsxs)("div",{className:"pt-4",children:[Object(y.jsxs)("button",{className:"mr-2 mb-2 text-sm disabled:opacity-50 disabled:cursor-default px-4 py-2 tracking-wide text-white transition-colors duration-200 transform bg-gray-700 rounded-md hover:bg-gray-600 focus:outline-none focus:bg-gray-600",disabled:t,type:"button",onClick:p.handleSubmit(v),children:[Object(y.jsx)(c.a,{className:"mr-2",icon:o.e}),Object(d.d)("common.save")]}),Object(y.jsxs)("button",{disabled:t,onClick:function(){Object.keys(b).forEach((function(e){p.setValue(e,b[e])}))},className:"mr-2 mb-2 text-sm disabled:opacity-50 disabled:cursor-default px-4 py-2 tracking-wide dark:border-gray-800 dark:bg-gray-800 dark:hover:bg-gray-600 dark:text-white text-gray-700 border border-gray-300 transition-colors duration-200 transform bg-white rounded-md hover:bg-gray-100 focus:outline-none focus:bg-gray-100",type:"button",children:[Object(y.jsx)(c.a,{className:"mr-2",icon:s.t}),Object(d.d)("common.reset")]}),e.onCancel?Object(y.jsxs)("button",{disabled:t,onClick:function(){return e.onCancel()},className:"mr-2 mb-2 text-sm disabled:opacity-50 disabled:cursor-default px-4 py-2 tracking-wide dark:border-gray-800 dark:bg-gray-800 dark:hover:bg-gray-600 dark:text-white text-gray-700 border border-gray-300 transition-colors duration-200 transform bg-white rounded-md hover:bg-gray-100 focus:outline-none focus:bg-gray-100",type:"button",children:[Object(y.jsx)(c.a,{className:"mr-2",icon:s.s}),Object(d.d)("common.cancel")]}):null]})]})}))}},786:function(e,t,n){"use strict";n.r(t);var r=n(135),a=n(4),o=n(27),s=n(28),c=n(2),i=n(84),l=n(5),u=function(e){return e.customer.form},d=Object(l.a)([u],(function(e){return e.record})),b={selectInitLoading:Object(l.a)([u],(function(e){return Boolean(e.initLoading)})),selectSaveLoading:Object(l.a)([u],(function(e){return Boolean(e.saveLoading)})),selectRecord:d,selectRaw:u},m=n(8),f=n(655),j=n(558),O=n(563),p=n(7);t.default=function(e){var t=Object(a.useState)(!1),n=Object(r.a)(t,2),l=n[0],u=n[1],d=Object(o.d)(),g=Object(s.h)(),h=Object(o.e)(b.selectInitLoading),v=Object(o.e)(b.selectSaveLoading),y=Object(o.e)(b.selectRecord),x=Boolean(g.params.id),w=x?Object(c.d)("entities.customer.edit.title"):Object(c.d)("entities.customer.new.title");return Object(a.useEffect)((function(){d(i.a.doInit(g.params.id)),u(!0)}),[d,g.params.id]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(j.a,{items:[[Object(c.d)("dashboard.menu"),"/"],[Object(c.d)("entities.customer.menu"),"/customer"],[w]]}),Object(p.jsxs)("div",{className:"mt-4 p-6 bg-white dark:bg-gray-800 dark:border-gray-800 text-gray-900 dark:text-gray-200 border-gray-200 border rounded-md",children:[Object(p.jsx)("h1",{className:"text-lg font-medium mb-6",children:w}),h&&Object(p.jsx)(O.a,{}),l&&!h&&Object(p.jsx)(f.a,{saveLoading:v,initLoading:h,record:y,isEditing:x,onSubmit:function(e,t){d(x?i.a.doUpdate(e,t):i.a.doCreate(t))},onCancel:function(){return Object(m.b)().push("/customer")}})]})]})}}}]);